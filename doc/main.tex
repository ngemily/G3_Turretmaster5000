\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{â‚¬}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\usepackage[usenames,dvipsnames]{color}
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={},
            pdftitle={TurretMaster5000 Docs},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{longtable,booktabs}
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}

\title{TurretMaster5000 Docs}
\date{}
\usepackage{fullpage}
\usepackage{bytefield}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[section]{placeins}

% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\begin{document}
\maketitle

\section{Register list}\label{register-list}

\begin{longtable}[c]{@{}lll@{}}
\caption{Table of AXI registers. `w' indicates read and write register,
`r' indicates read only register.}\tabularnewline
\toprule
address & r/w & description\tabularnewline
\midrule
\endfirsthead
\toprule
address & r/w & description\tabularnewline
\midrule
\endhead
5'h00 & r & obj\_m11\tabularnewline
5'h01 & r & obj\_m12\tabularnewline
5'h02 & r & obj\_m21\tabularnewline
5'h03 & r & rx\_read\_pointer\tabularnewline
5'h04 & r & tx\_write\_pointer\tabularnewline
5'h05 & r & tx\_read\_pointer\tabularnewline
5'h06 & r & rx\_fifo\_track\tabularnewline
5'h07 & r & tx\_fifo\_track\tabularnewline
5'h08 & r & mm2s\_tready\tabularnewline
5'h09 & r & mm2s\_tvalid\tabularnewline
5'h0A & r & s2mm\_tvalid\tabularnewline
5'h0B & r & s2mm\_tready\tabularnewline
5'h0C & w & ctrl\_reg1\tabularnewline
5'h0D & w & frame\_resetn\tabularnewline
5'h0E & r & laser\_xy\tabularnewline
5'h0F & w & ctrl\_reg2\tabularnewline
5'h10 & r & num\_labels\tabularnewline
5'h11 & r & obj\_area\tabularnewline
5'h12 & r & obj\_x\tabularnewline
5'h13 & r & obj\_y\tabularnewline
5'h14 & r & obj\_m20\tabularnewline
5'h15 & r & obj\_m02\tabularnewline
5'h16 & r & obj\_m30\tabularnewline
5'h17 & r & obj\_m03\tabularnewline
\bottomrule
\end{longtable}

\begin{figure}
    \centering

    \begin{subfigure}{\textwidth}
        \centering
        \begin{bytefield}[endianness=big]{32}
            \bitheader{31, 23, 15, 7, 0} \\
            \bitbox{8}{flood threshold}
            & \bitbox{8}{red threshold}
            & \bitbox{8}{sobel threshold}
            & \bitbox{8}{output mode}
            \\
        \end{bytefield}
        \caption{Control register 1.}
    \end{subfigure}

    \par\bigskip

    \begin{subfigure}{\textwidth}
        \centering
        \begin{bytefield}[endianness=big]{32}
            \bitheader{31, 23, 15, 11, 0} \\
            \bitbox{8}{flood 2 threshold}
            & \bitbox{8}{input only}
            & \bitbox{4}{unused}
            & \bitbox{12}{object id}
            \\
        \end{bytefield}
        \caption{Control register 2.}
    \end{subfigure}

    \caption{Control register layout.}
\end{figure}

\section{Mode enums}\label{mode-enums}

\begin{longtable}[c]{@{}ll@{}}
\toprule
i & mode\tabularnewline
\midrule
\endhead
0 & pass\tabularnewline
1 & gray\tabularnewline
2 & sobel\tabularnewline
3 & thresh\tabularnewline
7 & flood1\tabularnewline
8 & flood2\tabularnewline
4 & cc\tabularnewline
5 & color\tabularnewline
6 & laser\tabularnewline
\bottomrule
\end{longtable}

\section{Moment calculations}\label{moment-calculations}

\subsection{Translational invariants}\label{translational-invariants}

\[
u_{ij} = \sum_x \sum_y (x - \bar{x}) ^ i (y - \bar{y}) ^ j p_{ij}
\]

\subsection{Scale invariants}\label{scale-invariants}

\[
n_{ij} = \frac{u_{ij}}{u_{00} ^ {1 + \frac{i + j}{2}}}
\]

\subsection{Rotational invariants}\label{rotational-invariants}

\[
\begin{aligned}
I_0 &= n_{20} + n_{02} \\
I_1 &= (n_{20} - n_{02}) ^ 2 + 4 n_{11}^2 \\
I_2 &= (n_{30} - 3 n_{12}) ^ 2 + (3 n_{21} - n_{03}) ^ 2 \\
I_3 &= (n_{30} + n_{12}) ^ 2 + (n_{32} + n_{03}) ^ 2 \\
I_4 &= (n_{30} - 3 n_{12}) (n_{30} + n_{12})
        \left((n_{30} + n_{12}) ^ 2 - 3 (n_{21} + n_{03}) ^ 2\right) \\
        &+ (3 n_{21} - n_{03}) (n_{21} + n_{03})
        \left(3 (n_{30} + n_{12}) ^ 2 - (n_{21} + n_{03}) ^ 2\right) \\
I_5 &= (n_{20} - n_{02})
        \left((n_{30} + n_{12}) ^ 2 - (n_{21} + n_{03}) ^ 2\right) \\
        &+ 4 n_{11} (n_{30} + n_{12}) (n_{21} + n_{03}) \\
I_6 &= (3 n_{21} - n_{03}) (n_{30} + n_{12})
        \left((n_{30} + n_{12}) ^ 2 - 3 (n_{21} + n_{03}) ^ 2 \right) \\
        &- (n_{30} - 3 n_{12}) (n_{21} + n_{03})
        \left(3 (n_{30} + n_{12}) ^ 2 - (n_{21} + n_{03}) ^ 2 \right)
\end{aligned}
\]

\newpage

\subsection{Comparison}\label{comparison}

\[
x = \sum_{i=0}^5 \frac{(I_i - I^\prime_i) ^ 2}{I_i I^\prime_i}
\]

\section{UART commands}\label{uart-commands}

\subsection{Sound}\label{sound}

\subsection{IP Status}\label{ip-status}

\begin{description}
\tightlist
\item[\texttt{ipinfo}]
Read and display all memory mapped registers.
\end{description}

\subsection{IP Control}\label{ip-control}

\begin{description}
\tightlist
\item[\texttt{setobjid}]
Controls which object the IP will output information about (location,
area).
\end{description}

\subsection{Frame buffer}\label{frame-buffer}

\begin{description}
\tightlist
\item[\texttt{df1}]
df1
\item[\texttt{df2}]
df2
\item[\texttt{df0}]
df0
\item[\texttt{vf1}]
vf1
\item[\texttt{vf2}]
vf2
\item[\texttt{vf0}]
vf0
\end{description}

\subsection{SD card}\label{sd-card}

\begin{description}
\tightlist
\item[\texttt{lemon}]
lemon
\item[\texttt{heman}]
heman
\end{description}

\subsection{IP modes}\label{ip-modes}

These commands set the control signal to a mux at the IP output, to show
each stage of image processing.

\begin{description}
\tightlist
\item[\texttt{pass}]
Passthrough; show what the camera sees without any modifications.
\item[\texttt{gray}]
Grayscale.
\item[\texttt{sobel}]
Sobel edge detection.
\item[\texttt{thresh}]
Sobel passed through a threshold to get a binarized image.
\item[\texttt{label}]
Connected components label.
\item[\texttt{colour}]
Coloured connected components label.
\item[\texttt{laser}]
Laser detection; whatever objects the IP thinks is the laser.
\item[\texttt{flood1}]
First flooding stage.
\item[\texttt{flood2}]
Second flooding stage.
\end{description}

\subsection{Thresholds}\label{thresholds}

\begin{description}
\tightlist
\item[\texttt{redthresh}]
redthresh
\item[\texttt{setsobelthresh}]
setsobelthresh
\item[\texttt{setflood1thresh}]
setflood1thresh
\item[\texttt{setflood2thresh}]
setflood2thresh
\item[\texttt{setminsize}]
setminsize
\end{description}

\subsection{TODO uncategorized}\label{todo-uncategorized}

\begin{description}
\tightlist
\item[\texttt{test\_args}]
test\_args
\item[\texttt{ipouttoggle}]
ipouttoggle
\item[\texttt{dummytarget}]
dummytarget
\item[\texttt{laseron}]
laseron
\item[\texttt{laseroff}]
laseroff
\item[\texttt{test}]
test
\item[\texttt{record}]
record
\item[\texttt{play}]
play
\item[\texttt{kill}]
kill
\item[\texttt{exit}]
exit
\item[\texttt{dump}]
dump
\item[\texttt{lowlevel}]
lowlevel
\item[\texttt{highlevel}]
highlevel
\item[\texttt{lasertest}]
lasertest
\item[\texttt{motortest}]
motortest
\item[\texttt{stop}]
stop
\item[\texttt{load\_sounds}]
load\_sounds
\item[\texttt{load\_images}]
load\_images
\item[\texttt{still\_alive}]
still\_alive
\item[\texttt{gun}]
gun
\item[\texttt{portal\_gun}]
portal\_gun
\item[\texttt{target}]
target
\item[\texttt{manual}]
manual
\item[\texttt{auto}]
auto
\item[\texttt{passthrough}]
passthrough
\item[\texttt{runip}]
runip
\item[\texttt{videoinfo}]
videoinfo
\end{description}

\end{document}
